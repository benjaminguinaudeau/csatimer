mutate(time = time/60,
name = fct_reorder(name, time)) %>%
ggplot(aes(x = name, y = time, fill = ideology)) +
geom_col() +
facet_wrap(~station, scales = "free") +
coord_flip() +
scale_fill_manual(values = ideo_values) +
scale_x_discrete(labels = function(x) str_remove(x, ".*?ddd")) +
theme_minimal() +
theme(legend.position = "bottom") +
labs(y = "Airtime (in hours)\n", x = "Politicians",
title = "Which politician was most present in the French media?\nTV station ; October-December 2021",
fill = "") +
labs(caption = "Source: CSA via {csatimer} (https://tinyurl.com/2nx45psm) \nViz: @ben_guinaudeau")
pres_2022 %>%
filter(is_tv) %>%
mutate(station = fct_relevel(station, "TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC")) %>%
filter(as.numeric(station) < 13) %>% glimpse
pres_2022 %>%
add_station_dummies() %>%
filter(is_tv) %>%
mutate(station = fct_relevel(station, "TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC")) %>%
filter(as.numeric(station) < 13) %>% glimpse
pres_2022 %>%
add_station_dummies() %>%
filter(is_tv) %>%
mutate(station = fct_relevel(station, "TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC")) %>%
filter(as.numeric(station) < 13) %>%
group_by(name = cand) %>%
add_count(ideo) %>%
arrange(desc(n)) %>%
mutate(ideo = ideo[1]) %>%
ungroup %>%
group_by(station, name, ideo) %>%
summarise(time = sum(time)) %>%
ungroup %>%
group_by(station) %>%
slice_max(order_by = time, n = 10) %>%
ungroup %>%
mutate(name = paste0(station, "ddd", name)) %>%
mutate(time = time/60,
name = fct_reorder(name, time)) %>%
ggplot(aes(x = name, y = time, fill = ideo)) +
geom_col() +
facet_wrap(~station, scales = "free") +
coord_flip() +
scale_fill_manual(values = ideo_values) +
scale_x_discrete(labels = function(x) str_remove(x, ".*?ddd")) +
theme_minimal() +
theme(legend.position = "bottom") +
labs(y = "Airtime (in hours)\n", x = "Politicians",
title = "Which politician was most present in the French media?\nTV station ; October-December 2021",
fill = "") +
labs(caption = "Source: CSA via {csatimer} (https://tinyurl.com/2nx45psm) \nViz: @ben_guinaudeau")
pres_2022 %>%
add_station_dummies() %>%
filter(is_tv) %>%
mutate(station = fct_relevel(station, "TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC")) %>%
filter(as.numeric(station) < 13) %>%
group_by(name = cand) %>%
add_count(ideo) %>%
arrange(desc(n)) %>%
mutate(ideo = ideo[1]) %>%
ungroup %>%
group_by(station, name, ideo) %>%
summarise(time = sum(time)) %>%
ungroup %>%
mutate(name = paste0(station, "ddd", name)) %>%
mutate(time = time/60,
name = fct_reorder(name, time))
pres_2022 %>%
add_station_dummies() %>%
filter(is_tv) %>%
mutate(station = fct_relevel(station, "TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC")) %>%
filter(as.numeric(station) < 13) %>%  glimpse
pres_2022 %>%
add_station_dummies() %>%
filter(is_tv) %>%
mutate(station = fct_relevel(station, "TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC")) %>%
filter(as.numeric(station) < 13) %>%
group_by(name = cand) %>%
add_count(ideo) %>%
arrange(desc(n)) %>%
mutate(ideo = ideo[1]) %>%
ungroup %>%
group_by(station, name, ideo) %>%
summarise(time = sum(total_time, na.rm  =T)) %>%
ungroup %>%
mutate(name = paste0(station, "ddd", name)) %>%
mutate(time = time/60,
name = fct_reorder(name, time)) %>%
ggplot(aes(x = name, y = time, fill = ideo)) +
geom_col() +
facet_wrap(~station, scales = "free") +
coord_flip() +
scale_fill_manual(values = ideo_values) +
scale_x_discrete(labels = function(x) str_remove(x, ".*?ddd")) +
theme_minimal() +
theme(legend.position = "bottom") +
labs(y = "Airtime (in hours)\n", x = "Politicians",
title = "Which politician was most present in the French media?\nTV station ; October-December 2021",
fill = "") +
labs(caption = "Source: CSA via {csatimer} (https://tinyurl.com/2nx45psm) \nViz: @ben_guinaudeau")
pres_2022 %>%
add_station_dummies() %>%
filter(is_tv) %>%
count(station)
pres_2022 %>%
add_station_dummies() %>%
count(station)
pres_2022 %>%
add_station_dummies() %>%
count(station) %>%
pull(station) %>%
dput()
#' add_station_dummies
#' @description Adds two dummies: is_private captures private stations (vs public ones) and is_tv captures TV stations (vs radio ones)
#' @export
add_station_dummies <- function(.tbl){
.tbl %>%
dplyr::mutate(
is_private = !station %in% c("France 2", "France 3", "France 5", "France Culture", "France Inter", "France Info", "France Info TV", "Radio Classique",
"France 2", "France 24", "France 3", "France 5", "France Info TV", "France Culture", "France Info", "France Inter", "Radio Classique", "RFI", "TV5Monde"),
is_tv = station %in% c("TF1", "France 2", "France 3", "France 5", "M6", "Canal+", "BFM TV", "LCI", "France Info TV", "CNEWS", "TMC", "RMC Story", "RMC Découverte",
"C8", "Numéro 23",
"BFM TV", "C NEWS", "C8", "Euronews", "LCI", "M6", "RMC Découverte", "RMC Story", "RT France","TF1",
"France 2", "France 24", "France 3", "France 5", "France Info TV", "TV5Monde",
"Canal +", "C NEWS")
)
}
pres_2022 %>%
add_station_dummies() %>%
count(station) %>%
pull(station) %>%
dput()
pres_2022 %>%
add_station_dummies() %>%
filter(is_tv) %>%
filter(station %in% c("TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC"))
pres_2022 %>%
add_station_dummies() %>%
filter(is_tv) %>%
# filter(station %in% c("TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC"))
# mutate(station = fct_relevel(station, "TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC")) %>%
filter(as.numeric(station) < 13) %>%
group_by(name = cand) %>%
add_count(ideo) %>%
arrange(desc(n)) %>%
mutate(ideo = ideo[1]) %>%
ungroup %>%
group_by(station, name, ideo) %>%
summarise(time = sum(total_time, na.rm  =T)) %>%
ungroup %>%
mutate(name = paste0(station, "ddd", name)) %>%
mutate(time = time/60,
name = fct_reorder(name, time)) %>%
ggplot(aes(x = name, y = time, fill = ideo)) +
geom_col() +
facet_wrap(~station, scales = "free") +
coord_flip() +
scale_fill_manual(values = ideo_values) +
scale_x_discrete(labels = function(x) str_remove(x, ".*?ddd")) +
theme_minimal() +
theme(legend.position = "bottom") +
labs(y = "Airtime (in hours)\n", x = "Politicians",
title = "Which politician was most present in the French media?\nTV station ; October-December 2021",
fill = "") +
labs(caption = "Source: CSA via {csatimer} (https://tinyurl.com/2nx45psm) \nViz: @ben_guinaudeau")
pres_2022 %>%
add_station_dummies() %>%
filter(is_tv) %>%
# filter(station %in% c("TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC"))
# mutate(station = fct_relevel(station, "TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC")) %>%
# filter(as.numeric(station) < 13) %>%
group_by(name = cand) %>%
add_count(ideo) %>%
arrange(desc(n)) %>%
mutate(ideo = ideo[1]) %>%
ungroup %>%
group_by(station, name, ideo) %>%
summarise(time = sum(total_time, na.rm  =T)) %>%
ungroup %>%
mutate(name = paste0(station, "ddd", name)) %>%
mutate(time = time/60,
name = fct_reorder(name, time)) %>%
ggplot(aes(x = name, y = time, fill = ideo)) +
geom_col() +
facet_wrap(~station, scales = "free") +
coord_flip() +
scale_fill_manual(values = ideo_values) +
scale_x_discrete(labels = function(x) str_remove(x, ".*?ddd")) +
theme_minimal() +
theme(legend.position = "bottom") +
labs(y = "Airtime (in hours)\n", x = "Politicians",
title = "Which politician was most present in the French media?\nTV station ; October-December 2021",
fill = "") +
labs(caption = "Source: CSA via {csatimer} (https://tinyurl.com/2nx45psm) \nViz: @ben_guinaudeau")
pres_2022 %>%
add_station_dummies() %>%
filter(is_tv) %>%
# filter(station %in% c("TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC"))
# mutate(station = fct_relevel(station, "TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC")) %>%
# filter(as.numeric(station) < 13) %>%
group_by(name = cand) %>%
add_count(ideo) %>%
arrange(desc(n)) %>%
mutate(ideo = ideo[1]) %>%
ungroup %>%
group_by(station, name, ideo) %>%
summarise(time = sum(total_time, na.rm  =T)) %>%
ungroup %>%
mutate(name = paste0(station, "ddd", name)) %>%
mutate(time = time/60,
name = fct_reorder(name, time)) %>%
ggplot(aes(x = name, y = time, fill = ideo)) +
geom_col() +
facet_wrap(~station, scales = "free") +
coord_flip() +
scale_fill_manual(values = ideo_values) +
scale_x_discrete(labels = function(x) str_remove(x, ".*?ddd")) +
theme_minimal() +
theme(legend.position = "bottom") +
labs(y = "Airtime (in hours)\n", x = "Politicians",
title = "Which politician was most present in the French media?\nTV station ; October-December 2021",
fill = "") +
labs(caption = "Source: CSA via {csatimer} (https://tinyurl.com/2nx45psm) \nViz: @ben_guinaudeau")
pres_2022 %>%
add_station_dummies() %>%
filter(is_tv) %>%
filter(station %in% c("TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC", "RMC Story", "RT France", "TV5Monde")) %>%
mutate(station = fct_relevel(station, "TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC", "RMC Story", "RT France", "TV5Monde")) %>%
# filter(as.numeric(station) < 13) %>%
group_by(name = cand) %>%
add_count(ideo) %>%
arrange(desc(n)) %>%
mutate(ideo = ideo[1]) %>%
ungroup %>%
group_by(station, name, ideo) %>%
summarise(time = sum(total_time, na.rm  =T)) %>%
ungroup %>%
mutate(name = paste0(station, "ddd", name)) %>%
mutate(time = time/60,
name = fct_reorder(name, time)) %>%
ggplot(aes(x = name, y = time, fill = ideo)) +
geom_col() +
facet_wrap(~station, scales = "free") +
coord_flip() +
scale_fill_manual(values = ideo_values) +
scale_x_discrete(labels = function(x) str_remove(x, ".*?ddd")) +
theme_minimal() +
theme(legend.position = "bottom") +
labs(y = "Airtime (in hours)\n", x = "Politicians",
title = "Which politician was most present in the French media?\nTV station ; October-December 2021",
fill = "") +
labs(caption = "Source: CSA via {csatimer} (https://tinyurl.com/2nx45psm) \nViz: @ben_guinaudeau")
pres_2022 %>%
add_station_dummies() %>%
filter(is_tv) %>%
filter(station %in% c("TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC", "RMC Story", "RT France")) %>%
mutate(station = fct_relevel(station, "TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC", "RMC Story", "RT France")) %>%
# filter(as.numeric(station) < 13) %>%
group_by(name = cand) %>%
add_count(ideo) %>%
arrange(desc(n)) %>%
mutate(ideo = ideo[1]) %>%
ungroup %>%
group_by(station, name, ideo) %>%
summarise(time = sum(total_time, na.rm  =T)) %>%
ungroup %>%
mutate(name = paste0(station, "ddd", name)) %>%
mutate(time = time/60,
name = fct_reorder(name, time)) %>%
ggplot(aes(x = name, y = time, fill = ideo)) +
geom_col() +
facet_wrap(~station, scales = "free") +
coord_flip() +
scale_fill_manual(values = ideo_values) +
scale_x_discrete(labels = function(x) str_remove(x, ".*?ddd")) +
theme_minimal() +
theme(legend.position = "bottom") +
labs(y = "Airtime (in hours)\n", x = "Politicians",
title = "Which politician was most present in the French media?\nTV station ; October-December 2021",
fill = "") +
labs(caption = "Source: CSA via {csatimer} (https://tinyurl.com/2nx45psm) \nViz: @ben_guinaudeau")
pres_2022 %>%
add_station_dummies() %>%
filter(is_tv) %>%
filter(station %in% c("TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC", "RMC Story", "RT France")) %>%
mutate(station = fct_relevel(station, "TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC", "RMC Story", "RT France")) %>%
group_by(name = cand) %>%
add_count(ideo) %>%
arrange(desc(n)) %>%
mutate(ideo = ideo[1]) %>%
ungroup %>%
group_by(station, name, ideo) %>%
summarise(time = sum(total_time, na.rm  =T)) %>%
ungroup %>%
mutate(name = paste0(station, "ddd", name)) %>%
mutate(time = time/60,
name = fct_reorder(name, time)) %>%
ggplot(aes(x = name, y = time, fill = ideo)) +
geom_col() +
facet_wrap(~station, scales = "free") +
coord_flip() +
scale_fill_manual(values = ideo_values) +
scale_x_discrete(labels = function(x) str_remove(x, ".*?ddd")) +
theme_minimal() +
theme(legend.position = "bottom") +
labs(y = "Airtime (in hours)\n", x = "Politicians",
title = "Which politician was most present in the French media?\nTV station ; October-December 2021",
fill = "") +
labs(caption = "Source: CSA via {csatimer} (https://tinyurl.com/2nx45psm) \nViz: @ben_guinaudeau")
pres_2022 %>%
add_station_dummies() %>%
filter(is_tv) %>%
filter(station %in% c("TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC", "RMC Story", "RT France")) %>%
mutate(station = fct_relevel(station, "TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC", "RMC Story", "RT France")) %>%
group_by(name = cand) %>%
add_count(ideo) %>%
arrange(desc(n)) %>%
mutate(ideo = ideo[1]) %>%
ungroup %>%
group_by(station, name, ideo) %>%
summarise(time = sum(total_time, na.rm  =T)) %>%
ungroup %>%
mutate(name = paste0(station, "ddd", name)) %>%
mutate(time = time/60,
name = fct_reorder(name, time)) %>%
ggplot(aes(x = name, y = time, fill = ideo)) +
geom_col() +
facet_wrap(~station, scales = "free") +
coord_flip() +
scale_fill_manual(values = col_values) +
scale_x_discrete(labels = function(x) str_remove(x, ".*?ddd")) +
theme_minimal() +
theme(legend.position = "bottom") +
labs(y = "Airtime (in hours)\n", x = "Politicians",
title = "Which politician was most present in the French media?\nTV station ; October-December 2021",
fill = "") +
labs(caption = "Source: CSA via {csatimer} (https://tinyurl.com/2nx45psm) \nViz: @ben_guinaudeau")
pres_2022 %>%
add_station_dummies() %>%
filter(is_tv) %>%
filter(station %in% c("TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC", "RMC Story", "RT France")) %>%
mutate(station = fct_relevel(station, "TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC", "RMC Story", "RT France")) %>%
group_by(name = cand) %>%
add_count(ideo) %>%
arrange(desc(n)) %>%
mutate(ideo = ideo[1]) %>%
ungroup %>%
group_by(station, name, ideo) %>%
summarise(time = sum(total_time, na.rm  =T)) %>%
ungroup %>%
mutate(name = paste0(station, "ddd", name)) %>%
mutate(time = time/60,
name = fct_reorder(name, time)) %>%
ggplot(aes(x = name, y = time, fill = ideo)) +
geom_col() +
facet_wrap(~station, scales = "free") +
coord_flip() +
scale_fill_manual(values = col_values) +
scale_x_discrete(labels = function(x) str_remove(x, ".*?ddd")) +
theme_minimal() +
theme(legend.position = "bottom") +
labs(y = "Airtime (in hours)\n", x = "Politicians",
title = 'French presidential 2022 - Airtime by candidate<br> 01/01/2021 to 16/01/2021\n',
fill = "") +
labs(caption = "Source: CSA via {csatimer} (https://tinyurl.com/2nx45psm) \nViz: @ben_guinaudeau")
pres_2022 %>%
add_station_dummies() %>%
filter(is_tv) %>%
filter(station %in% c("TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC", "RMC Story", "RT France")) %>%
mutate(station = fct_relevel(station, "TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC", "RMC Story", "RT France")) %>%
group_by(name = cand) %>%
add_count(ideo) %>%
arrange(desc(n)) %>%
mutate(ideo = ideo[1]) %>%
ungroup %>%
group_by(station, name, ideo) %>%
summarise(time = sum(total_time, na.rm  =T)) %>%
ungroup %>%
mutate(name = paste0(station, "ddd", name)) %>%
mutate(time = time/60,
name = fct_reorder(name, time)) %>%
ggplot(aes(x = name, y = time, fill = ideo)) +
geom_col() +
facet_wrap(~station, scales = "free") +
coord_flip() +
scale_fill_manual(values = col_values) +
scale_x_discrete(labels = function(x) str_remove(x, ".*?ddd")) +
theme_minimal() +
theme(plot.title = element_markdown(hjust = .5),
legend.position = "bottom") +
labs(y = "Airtime (in hours)\n", x = "Politicians",
title = 'French presidential 2022 - Airtime by candidate<br> 01/01/2021 to 16/01/2021\n',
fill = "") +
labs(caption = "Source: CSA via {csatimer} (https://tinyurl.com/2nx45psm) \nViz: @ben_guinaudeau")
pres_2022 %>%
add_station_dummies() %>%
filter(is_tv) %>%
filter(station %in% c("TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC", "RMC Story", "RT France")) %>%
mutate(station = fct_relevel(station, "TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC", "RMC Story", "RT France")) %>%
group_by(name = cand) %>%
add_count(ideo) %>%
arrange(desc(n)) %>%
mutate(ideo = ideo[1]) %>%
ungroup %>%
group_by(station, name, ideo) %>%
summarise(time = sum(total_time, na.rm  =T)) %>%
ungroup %>%
mutate(name = paste0(station, "ddd", name)) %>%
mutate(time = time/60,
name = fct_reorder(name, time)) %>%
ggplot(aes(x = name, y = time, fill = ideo)) +
geom_col() +
facet_wrap(~station, scales = "free") +
coord_flip() +
scale_fill_manual(values = col_values) +
scale_x_discrete(labels = function(x) str_remove(x, ".*?ddd")) +
theme_minimal() +
theme(plot.title = element_markdown(hjust = .5),
legend.position = "bottom") +
labs(y = "Airtime (in hours)\n", x = "Politicians",
title = 'French presidential 2022 - Airtime by candidate<br> 01/01/2021 to 16/01/2021\n',
fill = "") +
labs(caption = "Source: CSA via {csatimer} (https://tinyurl.com/2nx45psm) \nViz: @ben_guinaudeau")
pres_2022 %>%
add_station_dummies() %>%
filter(is_tv) %>%
filter(station %in% c("TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC", "RMC Story", "RT France")) %>%
mutate(station = fct_relevel(station, "TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC", "RMC Story", "RT France")) %>%
group_by(name = cand) %>%
add_count(ideo) %>%
arrange(desc(n)) %>%
mutate(ideo = ideo[1]) %>%
ungroup %>%
group_by(station, name, ideo) %>%
summarise(time = sum(total_time, na.rm  =T)) %>%
ungroup %>%
mutate(name = paste0(station, "ddd", name)) %>%
mutate(time = time/60,
name = fct_reorder(name, time)) %>%
ggplot(aes(x = name, y = time, fill = ideo)) +
geom_col() +
facet_wrap(~station, scales = "free") +
coord_flip() +
scale_fill_manual(values = col_values) +
scale_x_discrete(labels = function(x) str_remove(x, ".*?ddd")) +
theme_minimal() +
theme(plot.title = element_markdown(hjust = .5),
legend.position = "bottom") +
labs(y = "Airtime (in hours)\n", x = "Politicians",
title = 'French presidential 2022 - Airtime by candidate<br> 01/01/2021 to 16/01/2021',
fill = "") +
labs(caption = "Source: CSA via {csatimer} (https://tinyurl.com/2nx45psm) \nViz: @ben_guinaudeau")
pres_2022 %>%
add_station_dummies() %>%
filter(is_tv) %>%
filter(station %in% c("TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC", "RMC Story", "RT France")) %>%
mutate(station = fct_relevel(station, "TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC", "RMC Story", "RT France")) %>%
group_by(name = cand) %>%
add_count(ideo) %>%
arrange(desc(n)) %>%
mutate(ideo = ideo[1]) %>%
ungroup %>%
group_by(station, name, ideo) %>%
summarise(time = sum(total_time, na.rm  =T)) %>%
ungroup %>%
mutate(name = paste0(station, "ddd", name)) %>%
mutate(time = time/60,
name = fct_reorder(name, time)) %>%
ggplot(aes(x = name, y = time, fill = ideo)) +
geom_col() +
facet_wrap(~station, scales = "free") +
coord_flip() +
scale_fill_manual(values = col_values) +
scale_x_discrete(labels = function(x) str_remove(x, ".*?ddd")) +
theme_minimal() +
theme(plot.title = element_markdown(hjust = 0),
legend.position = "bottom") +
labs(y = "Airtime (in hours)\n", x = "Politicians",
title = 'French presidential 2022 - Airtime by candidate<br> 01/01/2021 to 16/01/2021',
fill = "") +
labs(caption = "Source: CSA via {csatimer} (https://tinyurl.com/2nx45psm) \nViz: @ben_guinaudeau")
pres_2022 %>%
add_station_dummies() %>%
filter(is_tv) %>%
filter(station %in% c("TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC", "RMC Story", "RT France")) %>%
mutate(station = fct_relevel(station, "TF1", "France 2", "France 3", "Canal +", "France 5", "M6", "C8", "BFM TV", "LCI", "C NEWS", "France Info TV", "TMC", "RMC Story", "RT France")) %>%
group_by(name = cand) %>%
add_count(ideo) %>%
arrange(desc(n)) %>%
mutate(ideo = ideo[1]) %>%
ungroup %>%
group_by(station, name, ideo) %>%
summarise(time = sum(total_time, na.rm  =T)) %>%
ungroup %>%
mutate(name = paste0(station, "ddd", name)) %>%
mutate(time = time/60,
name = fct_reorder(name, time)) %>%
ggplot(aes(x = name, y = time, fill = ideo)) +
geom_col() +
facet_wrap(~station, scales = "free") +
coord_flip() +
scale_fill_manual(values = col_values) +
scale_x_discrete(labels = function(x) str_remove(x, ".*?ddd")) +
theme_minimal() +
theme(legend.position = "bottom") +
labs(y = "Airtime (in hours)\n", x = "Politicians",
title = 'French presidential 2022 - Airtime by candidate\n 01/01/2021 to 16/01/2021',
fill = "") +
labs(caption = "Source: CSA via {csatimer} (https://tinyurl.com/2nx45psm) \nViz: @ben_guinaudeau")
