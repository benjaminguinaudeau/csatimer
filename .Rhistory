count(path, radio) %>%
View
final_2020 <- tmp_2020 %>%
mutate(tv = str_detect(tolower(path), "info|g.neraliste"),
radio = str_detect(tolower(path), "radio"),
type = ifelse(str_detect(type, "JT"), "JT", type),
time = parse_time(time),
month = parse_month(month)) %>%
mutate(channel = channel %>%
str_trim() %>%
recode("BFM Business" = "BFM",
"Cnews" = "CNEWS",
"C NEWS" = "CNEWS",
"FranceInfo" = "France Info",
"FranceInter" = "France Inter",
"Frane Inter" = "France Inter",
"RMC Découvertes" = "RMC Découverte"),
channel = ifelse(channel == "France Info" & tv, "France Info TV", channel),
funct = funct %>%
recode_func(),
party_abb = fix_fun(funct),
ideo_pos = ideo_pos(funct),
party_abb = fct_reorder(party_abb, desc(ideo_pos))
) %>%
fix_name %>%
select(-ideo_pos) %>%
select(month, media = channel, tv, radio, prog_type = type, nom = name, appartenance = funct, party_abb, time) %>%
glimpse
final_2020 %>% count(media, tv, radio)
final_2020 <- tmp_2020 %>%
mutate(radio = str_detect(tolower(path), "radio"),
tv = !radio,
type = ifelse(str_detect(type, "JT"), "JT", type),
time = parse_time(time),
month = parse_month(month)) %>%
mutate(channel = channel %>%
str_trim() %>%
recode("BFM Business" = "BFM",
"Cnews" = "CNEWS",
"C NEWS" = "CNEWS",
"FranceInfo" = "France Info",
"FranceInter" = "France Inter",
"Frane Inter" = "France Inter",
"RMC Découvertes" = "RMC Découverte"),
channel = ifelse(channel == "France Info" & tv, "France Info TV", channel),
funct = funct %>%
recode_func(),
party_abb = fix_fun(funct),
ideo_pos = ideo_pos(funct),
party_abb = fct_reorder(party_abb, desc(ideo_pos))
) %>%
fix_name %>%
select(-ideo_pos) %>%
select(month, media = channel, tv, radio, prog_type = type, nom = name, appartenance = funct, party_abb, time) %>%
glimpse
final_2020 %>% count(media, tv, radio)
final_2020 <- tmp_2020 %>%
mutate(radio = str_detect(tolower(path), "radio"),
tv = !radio,
type = ifelse(str_detect(type, "JT"), "JT", type),
time = parse_time(time),
month = parse_month(month)) %>%
mutate(channel = channel %>%
str_trim() %>%
recode("BFM Business" = "BFM",
"Cnews" = "CNEWS",
"C NEWS" = "CNEWS",
"Frane 5" = "France 5",
"FranceInfo" = "France Info",
"France inter" = "France Inter",
"FranceInter" = "France Inter",
"Frane Inter" = "France Inter",
"RMC Découvertes" = "RMC Découverte"),
channel = ifelse(channel == "France Info" & tv, "France Info TV", channel),
funct = funct %>%
recode_func(),
party_abb = fix_fun(funct),
ideo_pos = ideo_pos(funct),
party_abb = fct_reorder(party_abb, desc(ideo_pos))
) %>%
fix_name %>%
select(-ideo_pos) %>%
select(month, media = channel, tv, radio, prog_type = type, nom = name, appartenance = funct, party_abb, time) %>%
glimpse
final_2020 %>% count(media, tv, radio)
final_2020 <- tmp_2020 %>%
mutate(radio = str_detect(tolower(path), "radio"),
tv = !radio,
type = ifelse(str_detect(type, "JT"), "JT", type),
time = parse_time(time),
month = parse_month(month)) %>%
mutate(channel = channel %>%
str_trim() %>%
recode("BFM Business" = "BFM",
"Cnews" = "CNEWS",
"C NEWS" = "CNEWS",
"Frane 5" = "France 5",
"FranceInfo" = "France Info",
"France inter" = "France Inter",
"FranceInter" = "France Inter",
"Frane Inter" = "France Inter",
"RMC Découvertes" = "RMC Découverte"),
channel = ifelse(channel == "France Info" & tv, "France Info TV", channel),
funct = funct %>%
recode_func(),
party_abb = fix_fun(funct),
ideo_pos = ideo_pos(funct),
party_abb = fct_reorder(party_abb, desc(ideo_pos))
) %>%
fix_name %>%
select(-ideo_pos) %>%
select(month, media = channel, tv, radio, prog_type = type, nom = name, appartenance = funct, party_abb, time, path) %>%
glimpse
final_2020 %>% filter(is.na(media))
tmp_2020 <- dir("raw_data/final/2020/", full.names = T) %>%
map_dfr(~{
rio::import(.x) %>%
mutate(path = .x) %>%
mutate(month = as.character(month))
})
final_2020 <- tmp_2020 %>%
mutate(radio = str_detect(tolower(path), "radio"),
tv = !radio,
type = ifelse(str_detect(type, "JT"), "JT", type),
time = parse_time(time),
month = parse_month(month)) %>%
mutate(channel = channel %>%
str_trim() %>%
recode("BFM Business" = "BFM",
"Cnews" = "CNEWS",
"C NEWS" = "CNEWS",
"Frane 5" = "France 5",
"FranceInfo" = "France Info",
"France inter" = "France Inter",
"FranceInter" = "France Inter",
"Frane Inter" = "France Inter",
"RMC Découvertes" = "RMC Découverte"),
channel = ifelse(channel == "France Info" & tv, "France Info TV", channel),
funct = funct %>%
recode_func(),
party_abb = fix_fun(funct),
ideo_pos = ideo_pos(funct),
party_abb = fct_reorder(party_abb, desc(ideo_pos))
) %>%
fix_name %>%
select(-ideo_pos) %>%
select(month, media = channel, tv, radio, prog_type = type, nom = name, appartenance = funct, party_abb, time, path) %>%
glimpse
final_2020 %>% count(media, tv, radio)
final_2020 %>% count(prog_type)
final_2020 %>% count(appartenance)
source('~/Downloads/csatimer/R/parsing_utils.R')
source('~/Downloads/csatimer/R/parsing_utils.R')
final_2020 %>% count(appartenance, sort = T)
final_2020 %>% count(appartenance, party_abb, sort = T)
summary(final_2021$time)
summary(final_2020$time)
write_rds(final_2020, here::here("final_data/2020.rds"))
readr::write_csv(final_2020, here::here("final_data/2020.csv"))
tmp_2019 <- dir("raw_data/final/2019/", full.names = T) %>%
map_dfr(~{
rio::import(.x) %>%
mutate(path = .x) %>%
mutate(month = as.character(month))
})
final_2019 <- tmp_2019 %>%
mutate(radio = str_detect(tolower(path), "radio"),
tv = !radio,
type = ifelse(str_detect(type, "JT"), "JT", type),
time = parse_time(time),
month = parse_month(month)) %>%
mutate(channel = channel %>%
str_trim() %>%
recode("BFM Business" = "BFM",
"Cnews" = "CNEWS",
"C NEWS" = "CNEWS",
"Frane 5" = "France 5",
"FranceInfo" = "France Info",
"France inter" = "France Inter",
"FranceInter" = "France Inter",
"Frane Inter" = "France Inter",
"RMC Découvertes" = "RMC Découverte"),
channel = ifelse(channel == "France Info" & tv, "France Info TV", channel),
funct = funct %>%
recode_func(),
party_abb = fix_fun(funct),
ideo_pos = ideo_pos(funct),
party_abb = fct_reorder(party_abb, desc(ideo_pos))
) %>%
fix_name %>%
select(-ideo_pos) %>%
select(month, media = channel, tv, radio, prog_type = type, nom = name, appartenance = funct, party_abb, time, path) %>%
glimpse
final_2020 <- tmp_2020 %>%
mutate(radio = str_detect(tolower(path), "radio"),
tv = !radio,
type = ifelse(str_detect(type, "JT"), "JT", type),
time = parse_time(time),
month = parse_month(month)) %>%
mutate(channel = channel %>%
str_trim() %>%
recode("BFM Business" = "BFM",
"Cnews" = "CNEWS",
"C NEWS" = "CNEWS",
"Frane 5" = "France 5",
"FranceInfo" = "France Info",
"France inter" = "France Inter",
"FranceInter" = "France Inter",
"Frane Inter" = "France Inter",
"RMC Découvertes" = "RMC Découverte"),
channel = ifelse(channel == "France Info" & tv, "France Info TV", channel),
funct = funct %>%
recode_func(),
party_abb = fix_fun(funct),
ideo_pos = ideo_pos(funct),
party_abb = fct_reorder(party_abb, desc(ideo_pos))
) %>%
fix_name %>%
select(-ideo_pos) %>%
select(month, media = channel, tv, radio, prog_type = type, nom = name, appartenance = funct, party_abb, time) %>%
glimpse
write_rds(final_2020, here::here("final_data/2020.rds"))
readr::write_csv(final_2020, here::here("final_data/2020.csv"))
final_2020 %>% filter(is.na(media))
final_2020 %>% count(media, tv, radio)
final_2020 %>% count(prog_type)
final_2020 %>% count(appartenance, party_abb, sort = T)
final_2019 %>% filter(is.na(media))
final_2019 %>% count(media, tv, radio)
final_2019 %>% count(prog_type)
final_2019 %>% filter(!prog_type %in% c("JT", "PROG", "MAG"))
final_2019 %>% filter(!prog_type %in% c("JT", "PROG", "MAG")) %>% count(prog_type, path)
final_2019 <- tmp_2019 %>%
mutate(radio = str_detect(tolower(path), "radio"),
tv = !radio,
type = ifelse(str_detect(type, "JT"), "JT", type),
time = parse_time(time),
month = parse_month(month)) %>%
mutate(channel = channel %>%
str_trim() %>%
recode("BFM Business" = "BFM",
"Cnews" = "CNEWS",
"C NEWS" = "CNEWS",
"Frane 5" = "France 5",
"FranceInfo" = "France Info",
"France inter" = "France Inter",
"FranceInter" = "France Inter",
"Frane Inter" = "France Inter",
"RMC Découvertes" = "RMC Découverte"),
channel = ifelse(channel == "France Info" & tv, "France Info TV", channel),
funct = funct %>%
recode_func(),
party_abb = fix_fun(funct),
ideo_pos = ideo_pos(funct),
party_abb = fct_reorder(party_abb, desc(ideo_pos))
) %>%
fix_name %>%
select(-ideo_pos) %>%
select(month, media = channel, tv, radio, prog_type = type, nom = name, appartenance = funct, party_abb, time, path) %>%
glimpse
final_2019 %>% filter(is.na(media))
final_2019 %>% count(media, tv, radio)
final_2019 %>% filter(!prog_type %in% c("JT", "PROG", "MAG")) %>% count(prog_type, path)
rio::import(.x) %>%
mutate(path = .x) %>%
mutate(month = as.character(month))
tmp_2019 <- dir("raw_data/final/2019/", full.names = T) %>%
map_dfr(~{
rio::import(.x) %>%
mutate(path = .x) %>%
mutate(month = as.character(month))
})
final_2019 <- tmp_2019 %>%
mutate(radio = str_detect(tolower(path), "radio"),
tv = !radio,
type = ifelse(str_detect(type, "JT"), "JT", type),
time = parse_time(time),
month = parse_month(month)) %>%
mutate(channel = channel %>%
str_trim() %>%
recode("BFM Business" = "BFM",
"Cnews" = "CNEWS",
"C NEWS" = "CNEWS",
"Frane 5" = "France 5",
"FranceInfo" = "France Info",
"France inter" = "France Inter",
"FranceInter" = "France Inter",
"Frane Inter" = "France Inter",
"RMC Découvertes" = "RMC Découverte"),
channel = ifelse(channel == "France Info" & tv, "France Info TV", channel),
funct = funct %>%
recode_func(),
party_abb = fix_fun(funct),
ideo_pos = ideo_pos(funct),
party_abb = fct_reorder(party_abb, desc(ideo_pos))
) %>%
fix_name %>%
select(-ideo_pos) %>%
select(month, media = channel, tv, radio, prog_type = type, nom = name, appartenance = funct, party_abb, time, path) %>%
glimpse
final_2019 %>% filter(is.na(media))
final_2019 %>% count(media, tv, radio)
final_2019 %>% filter(!prog_type %in% c("JT", "PROG", "MAG")) %>% count(prog_type, path)
final_2019 %>% count(appartenance, party_abb, sort = T)
final_2019 %>% count(appartenance, party_abb)
source('~/Downloads/csatimer/R/parsing_utils.R')
source('~/Downloads/csatimer/R/parsing_utils.R')
source('~/Downloads/csatimer/R/parsing_utils.R')
source('~/Downloads/csatimer/R/parsing_utils.R')
source('~/Downloads/csatimer/R/parsing_utils.R')
source('~/Downloads/csatimer/R/parsing_utils.R')
source('~/Downloads/csatimer/R/parsing_utils.R')
source('~/Downloads/csatimer/R/parsing_utils.R')
devtools::load_all(".")
tmp_2019 <- dir("raw_data/final/2019/", full.names = T) %>%
map_dfr(~{
rio::import(.x) %>%
mutate(path = .x) %>%
mutate(month = as.character(month))
})
final_2019 <- tmp_2019 %>%
mutate(radio = str_detect(tolower(path), "radio"),
tv = !radio,
type = ifelse(str_detect(type, "JT"), "JT", type),
time = parse_time(time),
month = parse_month(month)) %>%
mutate(channel = channel %>%
str_trim() %>%
recode("BFM Business" = "BFM",
"Cnews" = "CNEWS",
"C NEWS" = "CNEWS",
"Frane 5" = "France 5",
"FranceInfo" = "France Info",
"France inter" = "France Inter",
"FranceInter" = "France Inter",
"Frane Inter" = "France Inter",
"RMC Découvertes" = "RMC Découverte"),
channel = ifelse(channel == "France Info" & tv, "France Info TV", channel),
funct = funct %>%
recode_func(),
party_abb = fix_fun(funct),
ideo_pos = ideo_pos(funct),
party_abb = fct_reorder(party_abb, desc(ideo_pos))
) %>%
fix_name %>%
select(-ideo_pos) %>%
select(month, media = channel, tv, radio, prog_type = type, nom = name, appartenance = funct, party_abb, time, path) %>%
glimpse
final_2019 %>% filter(is.na(media))
final_2019 %>% count(media, tv, radio)
final_2019 %>% filter(!prog_type %in% c("JT", "PROG", "MAG")) %>% count(prog_type, path)
final_2019 %>% count(appartenance, party_abb)
final_2019 %>% count(appartenance, party_abb, sort = T)
summary(final_2019$time)
write_rds(final_2019, here::here("final_data/2019.rds"))
readr::write_csv(final_2019, here::here("final_data/2019.csv"))
tmp_2019 <- dir("raw_data/final/2019/", full.names = T) %>%
map_dfr(~{
rio::import(.x) %>%
mutate(path = .x) %>%
mutate(month = as.character(month))
})
final_2019 <- tmp_2019 %>%
mutate(radio = str_detect(tolower(path), "radio"),
tv = !radio,
type = ifelse(str_detect(type, "JT"), "JT", type),
time = parse_time(time),
month = parse_month(month)) %>%
mutate(channel = channel %>%
str_trim() %>%
recode("BFM Business" = "BFM",
"Cnews" = "CNEWS",
"C NEWS" = "CNEWS",
"Frane 5" = "France 5",
"FranceInfo" = "France Info",
"France inter" = "France Inter",
"FranceInter" = "France Inter",
"Frane Inter" = "France Inter",
"RMC Découvertes" = "RMC Découverte"),
channel = ifelse(channel == "France Info" & tv, "France Info TV", channel),
funct = funct %>%
recode_func(),
party_abb = fix_fun(funct),
ideo_pos = ideo_pos(funct),
party_abb = fct_reorder(party_abb, desc(ideo_pos))
) %>%
fix_name %>%
select(-ideo_pos) %>%
select(month, media = channel, tv, radio, prog_type = type, nom = name, appartenance = funct, party_abb, time) %>%
glimpse
final_2019 %>% filter(is.na(media))
final_2019 %>% count(media, tv, radio)
final_2019 %>% filter(!prog_type %in% c("JT", "PROG", "MAG")) %>% count(prog_type, path)
tmp_2019 <- dir("raw_data/final/2019/", full.names = T) %>%
map_dfr(~{
rio::import(.x) %>%
mutate(path = .x) %>%
mutate(month = as.character(month))
})
final_2019 <- tmp_2019 %>%
mutate(radio = str_detect(tolower(path), "radio"),
tv = !radio,
type = ifelse(str_detect(type, "JT"), "JT", type),
time = parse_time(time),
month = parse_month(month)) %>%
mutate(channel = channel %>%
str_trim() %>%
recode("BFM Business" = "BFM",
"Cnews" = "CNEWS",
"C NEWS" = "CNEWS",
"Frane 5" = "France 5",
"FranceInfo" = "France Info",
"France inter" = "France Inter",
"FranceInter" = "France Inter",
"Frane Inter" = "France Inter",
"RMC Découvertes" = "RMC Découverte"),
channel = ifelse(channel == "France Info" & tv, "France Info TV", channel),
funct = funct %>%
recode_func(),
party_abb = fix_fun(funct),
ideo_pos = ideo_pos(funct),
party_abb = fct_reorder(party_abb, desc(ideo_pos))
) %>%
fix_name %>%
select(-ideo_pos) %>%
select(month, media = channel, tv, radio, prog_type = type, nom = name, appartenance = funct, party_abb, time) %>%
glimpse
# final_2019 %>% filter(is.na(media))
# final_2019 %>% count(media, tv, radio)
# final_2019 %>% filter(!prog_type %in% c("JT", "PROG", "MAG")) %>% count(prog_type, path)
# final_2019 %>% count(appartenance, party_abb)
# final_2019 %>% count(appartenance, party_abb, sort = T)
# summary(final_2019$time)
write_rds(final_2019, here::here("final_data/2019.rds"))
readr::write_csv(final_2019, here::here("final_data/2019.csv"))
tmp_2020 <- dir("raw_data/final/2020/", full.names = T) %>%
map_dfr(~{
rio::import(.x) %>%
mutate(path = .x) %>%
mutate(month = as.character(month))
})
final_2020 <- tmp_2020 %>%
mutate(radio = str_detect(tolower(path), "radio"),
tv = !radio,
type = ifelse(str_detect(type, "JT"), "JT", type),
time = parse_time(time),
month = parse_month(month)) %>%
mutate(channel = channel %>%
str_trim() %>%
recode("BFM Business" = "BFM",
"Cnews" = "CNEWS",
"C NEWS" = "CNEWS",
"Frane 5" = "France 5",
"FranceInfo" = "France Info",
"France inter" = "France Inter",
"FranceInter" = "France Inter",
"Frane Inter" = "France Inter",
"RMC Découvertes" = "RMC Découverte"),
channel = ifelse(channel == "France Info" & tv, "France Info TV", channel),
funct = funct %>%
recode_func(),
party_abb = fix_fun(funct),
ideo_pos = ideo_pos(funct),
party_abb = fct_reorder(party_abb, desc(ideo_pos))
) %>%
fix_name %>%
select(-ideo_pos) %>%
select(month, media = channel, tv, radio, prog_type = type, nom = name, appartenance = funct, party_abb, time) %>%
glimpse
final_2020 %>% filter(is.na(media))
final_2020 %>% count(media, tv, radio)
final_2020 %>% count(prog_type)
final_2020 %>% count(appartenance, party_abb, sort = T)
summary(final_2020$time)
write_rds(final_2020, here::here("final_data/2020.rds"))
readr::write_csv(final_2020, here::here("final_data/2020.csv"))
out <- dir("raw_data/final/2021/", full.names = T) %>%
map_dfr(~{
rio::import(.x) %>%
mutate(path = .x) %>%
mutate(month = as.character(month))
})
final_2021 <- out %>%
mutate(tv = str_detect(tolower(path), "info|g.neraliste"),
radio = str_detect(tolower(path), "radio"),
type = ifelse(str_detect(type, "JT"), "JT", type),
time = parse_time(time),
month = parse_month(month)) %>%
mutate(channel = channel %>%
str_trim() %>%
recode("BFM Business" = "BFM", "Cnews" = "CNEWS", "FranceInfo" = "France Info",
"FranceInter" = "France Inter",
"Frane Inter" = "France Inter",
"RMC Découvertes" = "RMC Découverte"),
channel = ifelse(channel == "France Info" & tv, "France Info TV", channel),
funct = funct %>%
recode_func(),
party_abb = fix_fun(funct),
ideo_pos = ideo_pos(funct),
party_abb = fct_reorder(party_abb, desc(ideo_pos))
) %>%
fix_name %>%
select(-ideo_pos, -error) %>%
select(month, media = channel, tv, radio, prog_type = type, nom = name, appartenance = funct, party_abb, time) %>%
glimpse
final_2021 %>% count(media, tv, radio)
final_2021 %>% count(prog_type)
final_2021 %>% count(appartenance)
final_2021 %>% count(party_abb)
summary(final_2021$time)
write_rds(final_2021, here::here("final_data/2021.rds"))
readr::write_csv(final_2021, here::here("final_data/2021.csv"))
