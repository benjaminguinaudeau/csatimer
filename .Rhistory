candidat == "Pecresse Valerie" ~ "Right",
candidat == "Zemmour Eric" ~ "Far-Right",
candidat == "Le Pen Marine" ~ "Far-Right",
candidat == "Philippot Florian" ~ "Far-Right",
candidat == "Dupont Aignan Nicolas" ~ "Far-Right",
T ~ "Other"
),
ideology = fct_relevel(ideology, "Far-Left", "Left", "Center", "Right", "Far-Right")) %>%
# mutate(month = as.factor(month)) %>%
ggplot(aes(x = candidat, ymax = bias, ymin = 0, group = month, color = month)) +
# geom_linerange(position = position_dodge(width=0.6)) +
geom_boxplot(aes(y = bias, x = candidat, group = candidat, fill = ideology), inherit.aes = F, alpha = .6, color = "grey50", size = .5, outlier.shape = NA, show.legend = F) +
# geom_point(aes(x = candidat, y = bias, color = month), position = position_dodge(width=0.6)) +
geom_hline(yintercept = 0, linetype = 4) +
coord_flip() +
facet_wrap(~station, ncol = 4) +
theme_minimal() +
theme(axis.text = element_text()) +
scale_fill_manual(values = ideo_values_nogov) +
labs(x = "", y = "Proportion de temps d'antenne - Intentions de vote")
dd <- final %>%
left_join(polls_agg) %>%
filter(station %in% c("BFM TV", "C NEWS", "C8", "France 2", "France 5", "France Info TV", "LCI", "TF1")) %>%
mutate(station = station %>%
fct_relevel("TF1", "France 2", "France 5", "C8",  "BFM TV", "LCI", "C NEWS", "France Info TV"),
candidat = candidat %>%
fct_relevel("Poutou Philippe", "Arthaud Nathalie", "Roussel Fabien", "Melenchon Jean Luc", "Jadot Yannick",
"Hidalgo Anne", "Taubira Christiane", "Macron Emmanuel",  "Lassalle Jean", "Pecresse Valerie",
"Dupont Aignan Nicolas", "Le Pen Marine",
"Philippot Florian", "Zemmour Eric")) %>%
group_by(station, month) %>%
mutate(total_station = sum(time, na.rm = T)) %>%
group_by(station, candidat, int, month) %>%
summarise(prop = sum(time, na.rm = T)/unique(total_station)) %>%
mutate(bias = prop - int/100) %>%
mutate(
ideology = case_when(
candidat == "Melenchon Jean Luc" ~ "Far-Left",
candidat == "Poutou Philippe" ~ "Far-Left",
candidat == "Arthaud Nathalie" ~ "Far-Left",
candidat == "Roussel Fabien" ~ "Far-Left",
candidat == "Hidalgo Anne" ~ "Left",
candidat == "Larrouturou Pierre" ~ "Left",
candidat == "Montebourg Arnaud" ~ "Left",
candidat == "Jadot Yannick" ~ "Left",
candidat == "Taubira Christiane" ~ "Left",
candidat == "Macron Emmanuel" ~ "Center",
candidat == "Lassalle Jean" ~ "Center",
candidat == "Pecresse Valerie" ~ "Right",
candidat == "Zemmour Eric" ~ "Far-Right",
candidat == "Le Pen Marine" ~ "Far-Right",
candidat == "Philippot Florian" ~ "Far-Right",
candidat == "Dupont Aignan Nicolas" ~ "Far-Right",
T ~ "Other"
),
ideology = fct_relevel(ideology, "Far-Left", "Left", "Center", "Right", "Far-Right"))
dd %>%
# mutate(month = as.factor(month)) %>%
ggplot(aes(x = month, y = bias, color = ideology)) +
geom_line()
dd %>%
# mutate(month = as.factor(month)) %>%
ggplot(aes(x = month, y = bias, color = ideology, group = candidat)) +
geom_line()
dd %>%
count(candidat)
dput(unique(dd$candidat))
dd %>%
filter(candidat %in% c("Melenchon Jean Luc", "Jadot Yannick", "Hidalgo Anne", "Taubira Christiane",
"Macron Emmanuel", "Pecresse Valerie", "Le Pen Marine", "Zemmour Eric")) %>%
# mutate(month = as.factor(month)) %>%
ggplot(aes(x = month, y = bias, color = candidat, group = candidat)) +
geom_line()
dd %>%
filter(candidat %in% c("Melenchon Jean Luc", "Jadot Yannick", "Hidalgo Anne", "Taubira Christiane",
"Macron Emmanuel", "Pecresse Valerie", "Le Pen Marine", "Zemmour Eric")) %>%
# mutate(month = as.factor(month)) %>%
ggplot(aes(x = month, y = bias, color = candidat, group = candidat)) +
geom_line() +
facet_wrap(~station)
dd %>%
filter(candidat %in% c("Melenchon Jean Luc", "Jadot Yannick", "Hidalgo Anne", "Taubira Christiane",
"Macron Emmanuel", "Pecresse Valerie", "Le Pen Marine", "Zemmour Eric")) %>%
# mutate(month = as.factor(month)) %>%
ggplot(aes(x = month, y = bias, color = candidat, group = candidat)) +
geom_line() +
facet_wrap(~station, ncol = 4)
dd %>%
filter(candidat %in% c("Melenchon Jean Luc", "Jadot Yannick", "Hidalgo Anne", "Taubira Christiane",
"Macron Emmanuel", "Pecresse Valerie", "Le Pen Marine", "Zemmour Eric")) %>%
# mutate(month = as.factor(month)) %>%
ggplot(aes(x = month, y = bias, color = station, group = station)) +
geom_line() +
facet_wrap(~candidat, ncol = 4)
dd <- final %>%
left_join(polls_agg) %>%
filter(station %in% c("BFM TV", "C NEWS", "C8", "France 2", "France 5", "France Info TV", "LCI", "TF1")) %>%
mutate(station = station %>%
fct_relevel("TF1", "France 2", "France 5", "C8",  "BFM TV", "LCI", "C NEWS", "France Info TV"),
candidat = candidat %>%
fct_relevel("Poutou Philippe", "Arthaud Nathalie", "Roussel Fabien", "Melenchon Jean Luc", "Jadot Yannick",
"Hidalgo Anne", "Taubira Christiane", "Macron Emmanuel",  "Lassalle Jean", "Pecresse Valerie",
"Dupont Aignan Nicolas", "Le Pen Marine",
"Philippot Florian", "Zemmour Eric")) %>%
group_by(month) %>%
mutate(total_station = sum(time, na.rm = T)) %>%
group_by(candidat, int, month) %>%
summarise(prop = sum(time, na.rm = T)/unique(total_station)) %>%
mutate(bias = prop - int/100) %>%
mutate(
ideology = case_when(
candidat == "Melenchon Jean Luc" ~ "Far-Left",
candidat == "Poutou Philippe" ~ "Far-Left",
candidat == "Arthaud Nathalie" ~ "Far-Left",
candidat == "Roussel Fabien" ~ "Far-Left",
candidat == "Hidalgo Anne" ~ "Left",
candidat == "Larrouturou Pierre" ~ "Left",
candidat == "Montebourg Arnaud" ~ "Left",
candidat == "Jadot Yannick" ~ "Left",
candidat == "Taubira Christiane" ~ "Left",
candidat == "Macron Emmanuel" ~ "Center",
candidat == "Lassalle Jean" ~ "Center",
candidat == "Pecresse Valerie" ~ "Right",
candidat == "Zemmour Eric" ~ "Far-Right",
candidat == "Le Pen Marine" ~ "Far-Right",
candidat == "Philippot Florian" ~ "Far-Right",
candidat == "Dupont Aignan Nicolas" ~ "Far-Right",
T ~ "Other"
),
ideology = fct_relevel(ideology, "Far-Left", "Left", "Center", "Right", "Far-Right"))
dd %>%
filter(candidat %in% c("Melenchon Jean Luc", "Jadot Yannick", "Hidalgo Anne", "Taubira Christiane",
"Macron Emmanuel", "Pecresse Valerie", "Le Pen Marine", "Zemmour Eric")) %>%
# mutate(month = as.factor(month)) %>%
ggplot(aes(x = month, y = bias, color = station, group = station)) +
geom_line() +
facet_wrap(~candidat, ncol = 4)
dd %>%
filter(candidat %in% c("Melenchon Jean Luc", "Jadot Yannick", "Hidalgo Anne", "Taubira Christiane",
"Macron Emmanuel", "Pecresse Valerie", "Le Pen Marine", "Zemmour Eric")) %>%
# mutate(month = as.factor(month)) %>%
ggplot(aes(x = month, y = bias, color = candidat, group = candidat)) +
geom_line()
dd <- final %>%
left_join(polls_agg) %>%
add_station_dummies %>%
mutate(station_type = case_when(
is_tv & is_private ~ "Private TV",
is_tv & !is_private ~ "Public TV",
!is_tv & is_private ~ "Private Radio",
!is_tv & !is_private ~ "Public Radio"
)) %>%
# filter(station %in% c("BFM TV", "C NEWS", "C8", "France 2", "France 5", "France Info TV", "LCI", "TF1")) %>%
# mutate(station = station %>%
#          fct_relevel("TF1", "France 2", "France 5", "C8",  "BFM TV", "LCI", "C NEWS", "France Info TV"),
#        candidat = candidat %>%
#          fct_relevel("Poutou Philippe", "Arthaud Nathalie", "Roussel Fabien", "Melenchon Jean Luc", "Jadot Yannick",
#                      "Hidalgo Anne", "Taubira Christiane", "Macron Emmanuel",  "Lassalle Jean", "Pecresse Valerie",
#                      "Dupont Aignan Nicolas", "Le Pen Marine",
#                      "Philippot Florian", "Zemmour Eric")) %>%
group_by(month) %>%
mutate(total_station = sum(time, na.rm = T)) %>%
group_by(candidat, int, month) %>%
summarise(prop = sum(time, na.rm = T)/unique(total_station)) %>%
mutate(bias = prop - int/100) %>%
mutate(
ideology = case_when(
candidat == "Melenchon Jean Luc" ~ "Far-Left",
candidat == "Poutou Philippe" ~ "Far-Left",
candidat == "Arthaud Nathalie" ~ "Far-Left",
candidat == "Roussel Fabien" ~ "Far-Left",
candidat == "Hidalgo Anne" ~ "Left",
candidat == "Larrouturou Pierre" ~ "Left",
candidat == "Montebourg Arnaud" ~ "Left",
candidat == "Jadot Yannick" ~ "Left",
candidat == "Taubira Christiane" ~ "Left",
candidat == "Macron Emmanuel" ~ "Center",
candidat == "Lassalle Jean" ~ "Center",
candidat == "Pecresse Valerie" ~ "Right",
candidat == "Zemmour Eric" ~ "Far-Right",
candidat == "Le Pen Marine" ~ "Far-Right",
candidat == "Philippot Florian" ~ "Far-Right",
candidat == "Dupont Aignan Nicolas" ~ "Far-Right",
T ~ "Other"
),
ideology = fct_relevel(ideology, "Far-Left", "Left", "Center", "Right", "Far-Right"))
dd %>%
filter(candidat %in% c("Melenchon Jean Luc", "Jadot Yannick", "Hidalgo Anne", "Taubira Christiane",
"Macron Emmanuel", "Pecresse Valerie", "Le Pen Marine", "Zemmour Eric")) %>%
# mutate(month = as.factor(month)) %>%
ggplot(aes(x = month, y = bias, color = candidat, group = candidat)) +
geom_line()
dd <- final %>%
left_join(polls_agg) %>%
add_station_dummies %>%
mutate(station_type = case_when(
is_tv & is_private ~ "Private TV",
is_tv & !is_private ~ "Public TV",
!is_tv & is_private ~ "Private Radio",
!is_tv & !is_private ~ "Public Radio"
)) %>%
# filter(station %in% c("BFM TV", "C NEWS", "C8", "France 2", "France 5", "France Info TV", "LCI", "TF1")) %>%
# mutate(station = station %>%
#          fct_relevel("TF1", "France 2", "France 5", "C8",  "BFM TV", "LCI", "C NEWS", "France Info TV"),
#        candidat = candidat %>%
#          fct_relevel("Poutou Philippe", "Arthaud Nathalie", "Roussel Fabien", "Melenchon Jean Luc", "Jadot Yannick",
#                      "Hidalgo Anne", "Taubira Christiane", "Macron Emmanuel",  "Lassalle Jean", "Pecresse Valerie",
#                      "Dupont Aignan Nicolas", "Le Pen Marine",
#                      "Philippot Florian", "Zemmour Eric")) %>%
group_by(station_type, month) %>%
mutate(total_station = sum(time, na.rm = T)) %>%
group_by(station_type, candidat, int, month) %>%
summarise(prop = sum(time, na.rm = T)/unique(total_station)) %>%
mutate(bias = prop - int/100) %>%
mutate(
ideology = case_when(
candidat == "Melenchon Jean Luc" ~ "Far-Left",
candidat == "Poutou Philippe" ~ "Far-Left",
candidat == "Arthaud Nathalie" ~ "Far-Left",
candidat == "Roussel Fabien" ~ "Far-Left",
candidat == "Hidalgo Anne" ~ "Left",
candidat == "Larrouturou Pierre" ~ "Left",
candidat == "Montebourg Arnaud" ~ "Left",
candidat == "Jadot Yannick" ~ "Left",
candidat == "Taubira Christiane" ~ "Left",
candidat == "Macron Emmanuel" ~ "Center",
candidat == "Lassalle Jean" ~ "Center",
candidat == "Pecresse Valerie" ~ "Right",
candidat == "Zemmour Eric" ~ "Far-Right",
candidat == "Le Pen Marine" ~ "Far-Right",
candidat == "Philippot Florian" ~ "Far-Right",
candidat == "Dupont Aignan Nicolas" ~ "Far-Right",
T ~ "Other"
),
ideology = fct_relevel(ideology, "Far-Left", "Left", "Center", "Right", "Far-Right"))
dd %>%
filter(candidat %in% c("Melenchon Jean Luc", "Jadot Yannick", "Hidalgo Anne", "Taubira Christiane",
"Macron Emmanuel", "Pecresse Valerie", "Le Pen Marine", "Zemmour Eric")) %>%
# mutate(month = as.factor(month)) %>%
ggplot(aes(x = month, y = bias, color = candidat, group = candidat)) +
geom_line()
dd %>%
filter(candidat %in% c("Melenchon Jean Luc", "Jadot Yannick", "Hidalgo Anne", "Taubira Christiane",
"Macron Emmanuel", "Pecresse Valerie", "Le Pen Marine", "Zemmour Eric")) %>%
# mutate(month = as.factor(month)) %>%
ggplot(aes(x = month, y = bias, color = candidat, group = candidat)) +
geom_line() +
facet_wrap(~station_type, ncol = 4)
dd %>%
filter(candidat %in% c("Melenchon Jean Luc", "Jadot Yannick", "Hidalgo Anne", "Taubira Christiane",
"Macron Emmanuel", "Pecresse Valerie", "Le Pen Marine", "Zemmour Eric")) %>%
# mutate(month = as.factor(month)) %>%
ggplot(aes(x = month, y = bias, color = candidat, group = candidat)) +
geom_line() +
facet_wrap(~station_type, ncol = 2)
dd %>%
filter(candidat %in% c("Melenchon Jean Luc", "Jadot Yannick", "Hidalgo Anne", "Taubira Christiane",
"Macron Emmanuel", "Pecresse Valerie", "Le Pen Marine", "Zemmour Eric")) %>%
# mutate(month = as.factor(month)) %>%
ggplot(aes(x = month, y = bias, color = candidat, group = candidat)) +
geom_line() +
facet_wrap(~station_type, ncol = 2) +
theme_minimal() +
theme(axis.text = element_text()) +
scale_fill_manual(values = ideo_values_nogov)
dd %>%
filter(candidat %in% c("Melenchon Jean Luc", "Jadot Yannick", "Hidalgo Anne", "Taubira Christiane",
"Macron Emmanuel", "Pecresse Valerie", "Le Pen Marine", "Zemmour Eric")) %>%
# mutate(month = as.factor(month)) %>%
ggplot(aes(x = month, y = bias, color = candidat, group = candidat)) +
geom_line() +
facet_wrap(~station_type, ncol = 2) +
theme_minimal() +
theme(axis.text = element_text()) +
scale_color_manual(values = ideo_values_nogov)
dd %>%
filter(candidat %in% c("Melenchon Jean Luc", "Jadot Yannick", "Hidalgo Anne", "Taubira Christiane",
"Macron Emmanuel", "Pecresse Valerie", "Le Pen Marine", "Zemmour Eric")) %>%
# mutate(month = as.factor(month)) %>%
ggplot(aes(x = month, y = bias, color = candidat, group = candidat, color = ideology)) +
geom_line() +
facet_wrap(~station_type, ncol = 2) +
theme_minimal() +
theme(axis.text = element_text()) +
scale_color_manual(values = ideo_values_nogov)
dd %>%
filter(candidat %in% c("Melenchon Jean Luc", "Jadot Yannick", "Hidalgo Anne", "Taubira Christiane",
"Macron Emmanuel", "Pecresse Valerie", "Le Pen Marine", "Zemmour Eric")) %>%
# mutate(month = as.factor(month)) %>%
ggplot(aes(x = month, y = bias, group = candidat, color = ideology)) +
geom_line() +
facet_wrap(~station_type, ncol = 2) +
theme_minimal() +
theme(axis.text = element_text()) +
scale_color_manual(values = ideo_values_nogov)
precampaign <- dt %>%
filter(month >= lubridate::dmy("01-01-2021")) %>%
mutate(candidat = case_when(
party %in% c("LFI") ~ "Melenchon Jean Luc",
party %in% c("NPA") ~ "Poutou Philippe",
party %in% c("PCF") ~ "Roussel Fabien",
party %in% c("PS") ~ "Hidalgo Anne",
party %in% c("EELV") ~ "Jadot Yannick",
party %in% c("PRG") | name == "Taubira Christiane" ~ "Taubira Christiane",
party %in% c("LREM") | label %in% "Président De La République En Débat Politique" ~ "Macron Emmanuel",
party %in% c("LR", "Libres") ~ "Pecresse Valerie",
party %in% c("Reconquête") | name == "Zemmour Eric" ~ "Zemmour Eric",
party %in% c("RN") ~ "Le Pen Marine",
party %in% c("DlF") ~ "Dupont Aignan Nicolas",
party %in% c("Patriotes") ~ "Philippot Florian",
party %in% c("LO") ~ "Arthaud Nathalie",
name == "Lassalle Jean" ~ "Lassalle Jean",
T  ~ "Autres"
)) %>%
group_by(month, station, candidat) %>%
summarise(time = sum(time, na.rm = T)) %>%
ungroup %>%
mutate(campaign = F) %>%
glimpse
campaign <- pres_2022 %>%
mutate(month = lubridate::floor_date(date_end, unit = "month")) %>%
group_by(month, station, candidat) %>%
summarise(time = sum(total_time, na.rm = T)) %>%
ungroup %>%
mutate(campaign = T) %>%
glimpse
all_dt <- bind_rows(precampaign, campaign) %>%
filter(!candidat %in% "Autres") %>%
glimpse
dd <- final %>%
left_join(polls_agg) %>%
add_station_dummies %>%
mutate(station_type = case_when(
is_tv & is_private ~ "Private TV",
is_tv & !is_private ~ "Public TV",
!is_tv & is_private ~ "Private Radio",
!is_tv & !is_private ~ "Public Radio"
)) %>%
group_by(station_type, month) %>%
mutate(total_station = sum(time, na.rm = T)) %>%
group_by(station_type, candidat, int, month) %>%
summarise(prop = sum(time, na.rm = T)/unique(total_station)) %>%
mutate(bias = prop - int/100) %>%
mutate(
ideology = case_when(
candidat == "Melenchon Jean Luc" ~ "Far-Left",
candidat == "Poutou Philippe" ~ "Far-Left",
candidat == "Arthaud Nathalie" ~ "Far-Left",
candidat == "Roussel Fabien" ~ "Far-Left",
candidat == "Hidalgo Anne" ~ "Left",
candidat == "Larrouturou Pierre" ~ "Left",
candidat == "Montebourg Arnaud" ~ "Left",
candidat == "Jadot Yannick" ~ "Left",
candidat == "Taubira Christiane" ~ "Left",
candidat == "Macron Emmanuel" ~ "Center",
candidat == "Lassalle Jean" ~ "Center",
candidat == "Pecresse Valerie" ~ "Right",
candidat == "Zemmour Eric" ~ "Far-Right",
candidat == "Le Pen Marine" ~ "Far-Right",
candidat == "Philippot Florian" ~ "Far-Right",
candidat == "Dupont Aignan Nicolas" ~ "Far-Right",
T ~ "Other"
),
ideology = fct_relevel(ideology, "Far-Left", "Left", "Center", "Right", "Far-Right"))
dd %>%
filter(candidat %in% c("Melenchon Jean Luc", "Jadot Yannick", "Hidalgo Anne", "Taubira Christiane",
"Macron Emmanuel", "Pecresse Valerie", "Le Pen Marine", "Zemmour Eric")) %>%
# mutate(month = as.factor(month)) %>%
ggplot(aes(x = month, y = bias, group = candidat, color = ideology)) +
geom_line() +
facet_wrap(~station_type, ncol = 2) +
theme_minimal() +
theme(axis.text = element_text()) +
scale_color_manual(values = ideo_values_nogov)
all_cands <- unique(all_dt$candidat)
all_month <- unique(all_dt$month)
all_station <- unique(all_dt$station)
complete_cases <- expand_grid(candidat = all_cands, month = all_month, station = all_station) %>%
mutate(campaign = lubridate::year(month) == "2022")
final <- all_dt %>%
left_join(complete_cases) %>%
mutate(time = ifelse(is.na(time), 0, time)) %>%
group_by(month, station) %>%
mutate(total_station = sum(time, na.rm = T)) %>%
ungroup %>%
mutate(prop = time/total_station) %>%
glimpse
dd <- final %>%
left_join(polls_agg) %>%
add_station_dummies %>%
mutate(station_type = case_when(
is_tv & is_private ~ "Private TV",
is_tv & !is_private ~ "Public TV",
!is_tv & is_private ~ "Private Radio",
!is_tv & !is_private ~ "Public Radio"
)) %>%
group_by(station_type, month) %>%
mutate(total_station = sum(time, na.rm = T)) %>%
group_by(station_type, candidat, int, month) %>%
summarise(prop = sum(time, na.rm = T)/unique(total_station)) %>%
mutate(bias = prop - int/100) %>%
mutate(
ideology = case_when(
candidat == "Melenchon Jean Luc" ~ "Far-Left",
candidat == "Poutou Philippe" ~ "Far-Left",
candidat == "Arthaud Nathalie" ~ "Far-Left",
candidat == "Roussel Fabien" ~ "Far-Left",
candidat == "Hidalgo Anne" ~ "Left",
candidat == "Larrouturou Pierre" ~ "Left",
candidat == "Montebourg Arnaud" ~ "Left",
candidat == "Jadot Yannick" ~ "Left",
candidat == "Taubira Christiane" ~ "Left",
candidat == "Macron Emmanuel" ~ "Center",
candidat == "Lassalle Jean" ~ "Center",
candidat == "Pecresse Valerie" ~ "Right",
candidat == "Zemmour Eric" ~ "Far-Right",
candidat == "Le Pen Marine" ~ "Far-Right",
candidat == "Philippot Florian" ~ "Far-Right",
candidat == "Dupont Aignan Nicolas" ~ "Far-Right",
T ~ "Other"
),
ideology = fct_relevel(ideology, "Far-Left", "Left", "Center", "Right", "Far-Right"))
dd %>%
filter(candidat %in% c("Melenchon Jean Luc", "Jadot Yannick", "Hidalgo Anne", "Taubira Christiane",
"Macron Emmanuel", "Pecresse Valerie", "Le Pen Marine", "Zemmour Eric")) %>%
# mutate(month = as.factor(month)) %>%
ggplot(aes(x = month, y = bias, group = candidat, color = ideology)) +
geom_line() +
facet_wrap(~station_type, ncol = 2) +
theme_minimal() +
theme(axis.text = element_text()) +
scale_color_manual(values = ideo_values_nogov)
dd %>%
filter(candidat %in% c("Melenchon Jean Luc", "Jadot Yannick", "Hidalgo Anne", "Taubira Christiane",
"Macron Emmanuel", "Pecresse Valerie", "Le Pen Marine", "Zemmour Eric")) %>%
# mutate(month = as.factor(month)) %>%
ggplot(aes(x = month, y = bias, group = candidat, color = candidat)) +
geom_line() +
facet_wrap(~station_type, ncol = 2) +
theme_minimal() +
theme(axis.text = element_text())
knitr::opts_chunk$set(echo = TRUE)
coefs_df  <- expand_grid(
diff = rnorm(3),
term = letters[1:3],
model = letters[4:6]
)
library(tidyverse)
coefs_df  <- expand_grid(
diff = rnorm(3),
term = letters[1:3],
model = letters[4:6]
)
est1<- ggplot(coefs_df, aes(x=diff, y=term, group=Model, color=Model, shape=Model)) +
geom_pointrange(aes(xmin=diff_lower,xmax=diff_upper), size=1.1, fatten = 2,
position = position_dodge2(width = 0.75)) +
geom_vline(xintercept=0) +
labs(x="Difference in Predicted Public Support Estimate", y="", title="") +
scale_color_brewer(palette="PuOr")
est1
est> +
guides(colour=guide_legend(reverse=TRUE), fill = NULL)
est1 +
guides(colour=guide_legend(reverse=TRUE), fill = NULL)
coefs_df  <- expand_grid(
diff = rnorm(3),
term = letters[1:3],
model = letters[4:6]
) %>%
mutate(diff_lower = diff - .1, diff_upper = diff + .1)
est1<- ggplot(coefs_df, aes(x=diff, y=term, group=Model, color=Model, shape=Model)) +
geom_pointrange(aes(xmin=diff_lower,xmax=diff_upper), size=1.1, fatten = 2,
position = position_dodge2(width = 0.75)) +
geom_vline(xintercept=0) +
labs(x="Difference in Predicted Public Support Estimate", y="", title="") +
scale_color_brewer(palette="PuOr")
est1 +
theme_minimal() +
theme(legend.position = "top")
coefs_df  <- expand_grid(
diff = rnorm(3),
term = letters[1:3],
Model = letters[4:6]
) %>%
mutate(diff_lower = diff - .1, diff_upper = diff + .1)
est1<- ggplot(coefs_df, aes(x=diff, y=term, group=Model, color=Model, shape=Model)) +
geom_pointrange(aes(xmin=diff_lower,xmax=diff_upper), size=1.1, fatten = 2,
position = position_dodge2(width = 0.75)) +
geom_vline(xintercept=0) +
labs(x="Difference in Predicted Public Support Estimate", y="", title="") +
scale_color_brewer(palette="PuOr")
est1 +
theme_minimal() +
theme(legend.position = "top")
est1 +
guides(colour=guide_legend(reverse=TRUE),
fill = NULL)
est1 +
guides(colour=guide_legend(reverse=TRUE),
fill = guide_legend(reverse=TRUE),
shape = guide_legend(reverse=TRUE), )
est1 +
guides(colour=guide_legend(reverse=TRUE),
fill = guide_legend(reverse=TRUE),
shape = guide_legend(reverse=TRUE)) +
theme(legend.position = "top")
est1 +
theme_minimal() +
guides(colour=guide_legend(reverse=TRUE),
fill = guide_legend(reverse=TRUE),
shape = guide_legend(reverse=TRUE)) +
theme(legend.position = "top")
