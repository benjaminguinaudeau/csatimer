final_2019 <- tmp_2019 %>%
mutate(radio = str_detect(tolower(path), "radio"),
tv = !radio,
type = ifelse(str_detect(type, "JT"), "JT", type),
time = parse_time(time),
month = parse_month(month)) %>%
mutate(channel = channel %>%
str_trim() %>%
recode("BFM Business" = "BFM",
"Cnews" = "CNEWS",
"C NEWS" = "CNEWS",
"Frane 5" = "France 5",
"FranceInfo" = "France Info",
"France inter" = "France Inter",
"FranceInter" = "France Inter",
"Frane Inter" = "France Inter",
"RMC Découvertes" = "RMC Découverte"),
channel = ifelse(channel == "France Info" & tv, "France Info TV", channel),
funct = funct %>%
recode_func(),
party_abb = fix_fun(funct),
ideo_pos = ideo_pos(funct),
party_abb = fct_reorder(party_abb, desc(ideo_pos))
) %>%
fix_name %>%
select(-ideo_pos) %>%
select(month, media = channel, tv, radio, prog_type = type, nom = name, appartenance = funct, party_abb, time, path) %>%
glimpse
final_2019 %>% filter(is.na(media))
final_2019 %>% count(media, tv, radio)
final_2019 %>% filter(!prog_type %in% c("JT", "PROG", "MAG")) %>% count(prog_type, path)
final_2019 %>% count(appartenance, party_abb, sort = T)
final_2019 %>% count(appartenance, party_abb)
source('~/Downloads/csatimer/R/parsing_utils.R')
source('~/Downloads/csatimer/R/parsing_utils.R')
source('~/Downloads/csatimer/R/parsing_utils.R')
source('~/Downloads/csatimer/R/parsing_utils.R')
source('~/Downloads/csatimer/R/parsing_utils.R')
source('~/Downloads/csatimer/R/parsing_utils.R')
source('~/Downloads/csatimer/R/parsing_utils.R')
source('~/Downloads/csatimer/R/parsing_utils.R')
devtools::load_all(".")
tmp_2019 <- dir("raw_data/final/2019/", full.names = T) %>%
map_dfr(~{
rio::import(.x) %>%
mutate(path = .x) %>%
mutate(month = as.character(month))
})
final_2019 <- tmp_2019 %>%
mutate(radio = str_detect(tolower(path), "radio"),
tv = !radio,
type = ifelse(str_detect(type, "JT"), "JT", type),
time = parse_time(time),
month = parse_month(month)) %>%
mutate(channel = channel %>%
str_trim() %>%
recode("BFM Business" = "BFM",
"Cnews" = "CNEWS",
"C NEWS" = "CNEWS",
"Frane 5" = "France 5",
"FranceInfo" = "France Info",
"France inter" = "France Inter",
"FranceInter" = "France Inter",
"Frane Inter" = "France Inter",
"RMC Découvertes" = "RMC Découverte"),
channel = ifelse(channel == "France Info" & tv, "France Info TV", channel),
funct = funct %>%
recode_func(),
party_abb = fix_fun(funct),
ideo_pos = ideo_pos(funct),
party_abb = fct_reorder(party_abb, desc(ideo_pos))
) %>%
fix_name %>%
select(-ideo_pos) %>%
select(month, media = channel, tv, radio, prog_type = type, nom = name, appartenance = funct, party_abb, time, path) %>%
glimpse
final_2019 %>% filter(is.na(media))
final_2019 %>% count(media, tv, radio)
final_2019 %>% filter(!prog_type %in% c("JT", "PROG", "MAG")) %>% count(prog_type, path)
final_2019 %>% count(appartenance, party_abb)
final_2019 %>% count(appartenance, party_abb, sort = T)
summary(final_2019$time)
write_rds(final_2019, here::here("final_data/2019.rds"))
readr::write_csv(final_2019, here::here("final_data/2019.csv"))
tmp_2019 <- dir("raw_data/final/2019/", full.names = T) %>%
map_dfr(~{
rio::import(.x) %>%
mutate(path = .x) %>%
mutate(month = as.character(month))
})
final_2019 <- tmp_2019 %>%
mutate(radio = str_detect(tolower(path), "radio"),
tv = !radio,
type = ifelse(str_detect(type, "JT"), "JT", type),
time = parse_time(time),
month = parse_month(month)) %>%
mutate(channel = channel %>%
str_trim() %>%
recode("BFM Business" = "BFM",
"Cnews" = "CNEWS",
"C NEWS" = "CNEWS",
"Frane 5" = "France 5",
"FranceInfo" = "France Info",
"France inter" = "France Inter",
"FranceInter" = "France Inter",
"Frane Inter" = "France Inter",
"RMC Découvertes" = "RMC Découverte"),
channel = ifelse(channel == "France Info" & tv, "France Info TV", channel),
funct = funct %>%
recode_func(),
party_abb = fix_fun(funct),
ideo_pos = ideo_pos(funct),
party_abb = fct_reorder(party_abb, desc(ideo_pos))
) %>%
fix_name %>%
select(-ideo_pos) %>%
select(month, media = channel, tv, radio, prog_type = type, nom = name, appartenance = funct, party_abb, time) %>%
glimpse
final_2019 %>% filter(is.na(media))
final_2019 %>% count(media, tv, radio)
final_2019 %>% filter(!prog_type %in% c("JT", "PROG", "MAG")) %>% count(prog_type, path)
tmp_2019 <- dir("raw_data/final/2019/", full.names = T) %>%
map_dfr(~{
rio::import(.x) %>%
mutate(path = .x) %>%
mutate(month = as.character(month))
})
final_2019 <- tmp_2019 %>%
mutate(radio = str_detect(tolower(path), "radio"),
tv = !radio,
type = ifelse(str_detect(type, "JT"), "JT", type),
time = parse_time(time),
month = parse_month(month)) %>%
mutate(channel = channel %>%
str_trim() %>%
recode("BFM Business" = "BFM",
"Cnews" = "CNEWS",
"C NEWS" = "CNEWS",
"Frane 5" = "France 5",
"FranceInfo" = "France Info",
"France inter" = "France Inter",
"FranceInter" = "France Inter",
"Frane Inter" = "France Inter",
"RMC Découvertes" = "RMC Découverte"),
channel = ifelse(channel == "France Info" & tv, "France Info TV", channel),
funct = funct %>%
recode_func(),
party_abb = fix_fun(funct),
ideo_pos = ideo_pos(funct),
party_abb = fct_reorder(party_abb, desc(ideo_pos))
) %>%
fix_name %>%
select(-ideo_pos) %>%
select(month, media = channel, tv, radio, prog_type = type, nom = name, appartenance = funct, party_abb, time) %>%
glimpse
# final_2019 %>% filter(is.na(media))
# final_2019 %>% count(media, tv, radio)
# final_2019 %>% filter(!prog_type %in% c("JT", "PROG", "MAG")) %>% count(prog_type, path)
# final_2019 %>% count(appartenance, party_abb)
# final_2019 %>% count(appartenance, party_abb, sort = T)
# summary(final_2019$time)
write_rds(final_2019, here::here("final_data/2019.rds"))
readr::write_csv(final_2019, here::here("final_data/2019.csv"))
tmp_2020 <- dir("raw_data/final/2020/", full.names = T) %>%
map_dfr(~{
rio::import(.x) %>%
mutate(path = .x) %>%
mutate(month = as.character(month))
})
final_2020 <- tmp_2020 %>%
mutate(radio = str_detect(tolower(path), "radio"),
tv = !radio,
type = ifelse(str_detect(type, "JT"), "JT", type),
time = parse_time(time),
month = parse_month(month)) %>%
mutate(channel = channel %>%
str_trim() %>%
recode("BFM Business" = "BFM",
"Cnews" = "CNEWS",
"C NEWS" = "CNEWS",
"Frane 5" = "France 5",
"FranceInfo" = "France Info",
"France inter" = "France Inter",
"FranceInter" = "France Inter",
"Frane Inter" = "France Inter",
"RMC Découvertes" = "RMC Découverte"),
channel = ifelse(channel == "France Info" & tv, "France Info TV", channel),
funct = funct %>%
recode_func(),
party_abb = fix_fun(funct),
ideo_pos = ideo_pos(funct),
party_abb = fct_reorder(party_abb, desc(ideo_pos))
) %>%
fix_name %>%
select(-ideo_pos) %>%
select(month, media = channel, tv, radio, prog_type = type, nom = name, appartenance = funct, party_abb, time) %>%
glimpse
final_2020 %>% filter(is.na(media))
final_2020 %>% count(media, tv, radio)
final_2020 %>% count(prog_type)
final_2020 %>% count(appartenance, party_abb, sort = T)
summary(final_2020$time)
write_rds(final_2020, here::here("final_data/2020.rds"))
readr::write_csv(final_2020, here::here("final_data/2020.csv"))
out <- dir("raw_data/final/2021/", full.names = T) %>%
map_dfr(~{
rio::import(.x) %>%
mutate(path = .x) %>%
mutate(month = as.character(month))
})
final_2021 <- out %>%
mutate(tv = str_detect(tolower(path), "info|g.neraliste"),
radio = str_detect(tolower(path), "radio"),
type = ifelse(str_detect(type, "JT"), "JT", type),
time = parse_time(time),
month = parse_month(month)) %>%
mutate(channel = channel %>%
str_trim() %>%
recode("BFM Business" = "BFM", "Cnews" = "CNEWS", "FranceInfo" = "France Info",
"FranceInter" = "France Inter",
"Frane Inter" = "France Inter",
"RMC Découvertes" = "RMC Découverte"),
channel = ifelse(channel == "France Info" & tv, "France Info TV", channel),
funct = funct %>%
recode_func(),
party_abb = fix_fun(funct),
ideo_pos = ideo_pos(funct),
party_abb = fct_reorder(party_abb, desc(ideo_pos))
) %>%
fix_name %>%
select(-ideo_pos, -error) %>%
select(month, media = channel, tv, radio, prog_type = type, nom = name, appartenance = funct, party_abb, time) %>%
glimpse
final_2021 %>% count(media, tv, radio)
final_2021 %>% count(prog_type)
final_2021 %>% count(appartenance)
final_2021 %>% count(party_abb)
summary(final_2021$time)
write_rds(final_2021, here::here("final_data/2021.rds"))
readr::write_csv(final_2021, here::here("final_data/2021.csv"))
knitr::opts_chunk$set(echo = TRUE)
dir(here::here("final_data"), pattern = ".rds")
all_year <- dir(here::here("final_data"), pattern = ".rds", full.names = T) %>%
map_dfr(readr::read_rds)
pacman::p_load(tidyverse)
all_year <- dir(here::here("final_data"), pattern = ".rds", full.names = T) %>%
map_dfr(readr::read_rds)
all_year
all_year <- dir(here::here("final_data"), pattern = ".rds", full.names = T) %>%
map_dfr(readr::read_rds) %>%
glimpse
usethis::use_data(all_year)
usethis::use_r("read_csa_time")
usethis::use_data(all_year, internal = T, compress = "gzip")
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
library(csatimer)
read_csa_time()
usethis::use_readme_rmd()
dplyr::glimpse(csatimer::read_csa_time())
library(csatimer)
devtools::load_all(".")
getwd()
knitr::opts_chunk$set(echo = TRUE)
link <- "raw_data/raw/2021/perso/Personnalites_Radio_01-11-2021_30-11-2021.odt"
get_dest
devtools::load_all(".")
link <- "raw_data/raw/2021/perso/Personnalites_Radio_01-11-2021_30-11-2021.odt"
out <- parse_odt_perso(link)
getwd()
knitr::opts_chunk$set(echo = TRUE)
link <- "../raw_data/raw/2021/perso/Personnalites_Chaine_d_information_01-11-2021_30-11-2021.odt"
out <- parse_pdf_perso(link, month = "11/2021")
source('~/gdrive/Konstanz/SideProjects/package/csatimer/scripts/parsing_utils.R')
source('~/gdrive/Konstanz/SideProjects/package/csatimer/scripts/scraping_utils.R')
out <- parse_odt_perso(link, month = "11/2021")
source('~/gdrive/Konstanz/SideProjects/package/csatimer/scripts/scraping_utils.R')
source('~/gdrive/Konstanz/SideProjects/package/csatimer/scripts/scraping_utils.R')
link <- "../raw_data/raw/2021/perso/Personnalites_Chaine_d_information_01-11-2021_30-11-2021.odt"
out <- parse_odt_perso(link, month = "11/2021")
devtools::load_all(".")
library(tidyverse)
link <- "../raw_data/raw/2021/perso/Personnalites_Chaine_d_information_01-11-2021_30-11-2021.odt"
out <- parse_odt_perso(link, month = "11/2021")
rio::export(out, get_dest(link))
out
source('~/gdrive/Konstanz/SideProjects/package/csatimer/scripts/scraping_utils.R')
out <- parse_odt_perso(link, month = "11/2021")
link <- "../raw_data/raw/2021/perso/Personnalites_Chaine_d_information_01-11-2021_30-11-2021.odt"
out <- parse_odt_perso(link, month = "11/2021") ; rio::export(out, get_dest(link))
link <- "../raw_data/raw/2021/perso/Personnalites_Chaine_generaliste_01-11-2021_30-11-2021.odt"
out <- parse_pdf_perso(link, month = "11/2021") ; rio::export(out, get_dest(link))
link <- "../raw_data/raw/2021/perso/Personnalites_Chaine_d_information_01-11-2021_30-11-2021.odt"
out <- parse_odt_perso(link, month = "11/2021") ; rio::export(out, get_dest(link))
link <- "../raw_data/raw/2021/perso/Personnalites_Chaine_generaliste_01-11-2021_30-11-2021.odt"
out <- parse_odt_perso(link, month = "11/2021") ; rio::export(out, get_dest(link))
link <- "../raw_data/raw/2021/perso/Personnalites_Radio_01-11-2021_30-11-2021.odt"
out <- parse_odt_perso(link, month = "11/2021") ; rio::export(out, get_dest(link))
source('~/gdrive/Konstanz/SideProjects/package/csatimer/scripts/scraping_utils.R')
source('~/gdrive/Konstanz/SideProjects/package/csatimer/scripts/scraping_utils.R')
link <- "../raw_data/raw/2021/perso/Personnalites_Chaine_d_information_01-11-2021_30-11-2021.odt"
out <- parse_odt_perso(link, month = "11/2021") ; rio::export(out, get_dest(link))
link <- "../raw_data/raw/2021/perso/Personnalites_Chaine_generaliste_01-11-2021_30-11-2021.odt"
out <- parse_odt_perso(link, month = "11/2021") ; rio::export(out, get_dest(link))
link <- "../raw_data/raw/2021/perso/Personnalites_Radio_01-11-2021_30-11-2021.odt"
out <- parse_odt_perso(link, month = "11/2021") ; rio::export(out, get_dest(link))
source('~/gdrive/Konstanz/SideProjects/package/csatimer/scripts/scraping_utils.R')
source('~/gdrive/Konstanz/SideProjects/package/csatimer/scripts/scraping_utils.R')
link <- "../raw_data/raw/2021/perso/Personnalites_Chaine_d_information_01-11-2021_30-11-2021.odt"
out <- parse_odt_perso(link, month = "11/2021") ; rio::export(out, get_dest(link))
link <- "../raw_data/raw/2021/perso/Personnalites_Chaine_generaliste_01-11-2021_30-11-2021.odt"
out <- parse_odt_perso(link, month = "11/2021") ; rio::export(out, get_dest(link))
out <- dir("raw_data/final/2021/", full.names = T) %>%
map_dfr(~{
rio::import(.x) %>%
mutate(path = .x) %>%
mutate(month = as.character(month))
})
final_2021 <- out %>%
mutate(tv = str_detect(tolower(path), "info|g.neraliste"),
radio = str_detect(tolower(path), "radio"),
type = ifelse(str_detect(type, "JT"), "JT", type),
time = parse_time(time),
month = parse_month(month)) %>%
mutate(channel = channel %>%
str_trim() %>%
recode("BFM Business" = "BFM", "Cnews" = "CNEWS", "FranceInfo" = "France Info",
"FranceInter" = "France Inter",
"Frane Inter" = "France Inter",
"RMC Découvertes" = "RMC Découverte"),
channel = ifelse(channel == "France Info" & tv, "France Info TV", channel),
funct = funct %>%
recode_func(),
party_abb = fix_fun(funct),
ideo_pos = ideo_pos(funct),
party_abb = fct_reorder(party_abb, desc(ideo_pos))
) %>%
fix_name %>%
select(-ideo_pos, -error) %>%
select(month, media = channel, tv, radio, prog_type = type, nom = name, appartenance = funct, party_abb, time) %>%
glimpse
out <- dir("raw_data/final/2021/", full.names = T) %>%
map_dfr(~{
rio::import(.x) %>%
mutate(path = .x) %>%
mutate(month = as.character(month))
})
final_2021 <- out %>%
mutate(tv = str_detect(tolower(path), "info|g.neraliste"),
radio = str_detect(tolower(path), "radio"),
type = ifelse(str_detect(type, "JT"), "JT", type),
time = parse_time(time),
month = parse_month(month)) %>%
mutate(channel = channel %>%
str_trim() %>%
recode("BFM Business" = "BFM", "Cnews" = "CNEWS", "FranceInfo" = "France Info",
"FranceInter" = "France Inter",
"Frane Inter" = "France Inter",
"RMC Découvertes" = "RMC Découverte"),
channel = ifelse(channel == "France Info" & tv, "France Info TV", channel),
funct = funct %>%
recode_func(),
party_abb = fix_fun(funct),
ideo_pos = ideo_pos(funct),
party_abb = fct_reorder(party_abb, desc(ideo_pos))
) %>%
fix_name %>%
select(-ideo_pos, -error) %>%
select(month, media = channel, tv, radio, prog_type = type, nom = name, appartenance = funct, party_abb, time) %>%
glimpse
final_2021 <- out %>% glimpse
tmp_2021 <- dir("raw_data/final/2021/", full.names = T) %>%
map_dfr(~{
rio::import(.x) %>%
mutate(path = .x) %>%
mutate(month = as.character(month))
})
tmp_2021
dir("raw_data/final/2021/", full.names = T)
tmp_2021 <- dir("../raw_data/final/2021/", full.names = T) %>%
map_dfr(~{
rio::import(.x) %>%
mutate(path = .x) %>%
mutate(month = as.character(month))
})
final_2021 <- tmp_2021 %>%
mutate(tv = str_detect(tolower(path), "info|g.neraliste"),
radio = str_detect(tolower(path), "radio"),
type = ifelse(str_detect(type, "JT"), "JT", type),
time = parse_time(time),
month = parse_month(month)) %>%
mutate(channel = channel %>%
str_trim() %>%
recode("BFM Business" = "BFM", "Cnews" = "CNEWS", "FranceInfo" = "France Info",
"FranceInter" = "France Inter",
"Frane Inter" = "France Inter",
"RMC Découvertes" = "RMC Découverte"),
channel = ifelse(channel == "France Info" & tv, "France Info TV", channel),
funct = funct %>%
recode_func(),
party_abb = fix_fun(funct),
ideo_pos = ideo_pos(funct),
party_abb = fct_reorder(party_abb, desc(ideo_pos))
) %>%
fix_name %>%
select(-ideo_pos, -error) %>%
select(month, media = channel, tv, radio, prog_type = type, nom = name, appartenance = funct, party_abb, time) %>%
glimpse
final_2021 %>% count(media, tv, radio)
final_2021 %>% count(prog_type)
final_2021 %>% count(appartenance)
final_2021 %>% count(party_abb)
summary(final_2021$time)
source('~/gdrive/Konstanz/SideProjects/package/csatimer/scripts/parsing_utils.R')
recode_channel <- function(x){
recode(x,
"BFM Business" = "BFM",
"BFM TW" = "BFM TV",
"Cnews" = "CNEWS",
"C NEWS" = "CNEWS",
"Frane 5" = "France 5",
"FranceInfo" = "France Info",
"France inter" = "France Inter",
"FranceInter" = "France Inter",
"Frane Inter" = "France Inter",
"RMC Découvertes" = "RMC Découverte")
}
source('~/gdrive/Konstanz/SideProjects/package/csatimer/scripts/parsing_utils.R')
final_2021 <- tmp_2021 %>%
mutate(tv = str_detect(tolower(path), "info|g.neraliste"),
radio = str_detect(tolower(path), "radio"),
type = ifelse(str_detect(type, "JT"), "JT", type),
time = parse_time(time),
month = parse_month(month)) %>%
mutate(channel = channel %>%
str_trim() %>%
recode_channel,
channel = ifelse(channel == "France Info" & tv, "France Info TV", channel),
funct = funct %>%
recode_func(),
party_abb = fix_fun(funct),
ideo_pos = ideo_pos(funct),
party_abb = fct_reorder(party_abb, desc(ideo_pos))
) %>%
fix_name %>%
select(-ideo_pos, -error) %>%
select(month, media = channel, tv, radio, prog_type = type, nom = name, appartenance = funct, party_abb, time) %>%
glimpse
final_2021 %>% count(media, tv, radio)
final_2021 <- tmp_2021 %>%
mutate(tv = str_detect(tolower(path), "info|g.neraliste"),
radio = str_detect(tolower(path), "radio"),
type = ifelse(str_detect(type, "JT"), "JT", type),
time = parse_time(time),
month = parse_month(month)) %>%
mutate(channel = channel %>%
str_trim() %>%
recode_channel,
channel = ifelse(channel == "France Info" & tv, "France Info TV", channel),
funct = funct %>%
recode_func(),
party_abb = fix_fun(funct),
ideo_pos = ideo_pos(funct),
party_abb = fct_reorder(party_abb, desc(ideo_pos))
) %>%
fix_name %>%
select(-ideo_pos, -error) %>%
select(month, media = channel, tv, radio, prog_type = type, nom = name, appartenance = funct, party_abb, time, path) %>%
glimpse
final_2021 %>% count(is.na(media), path)
final_2021 %>% count(a = is.na(media), path) %>% filter(a)
rio::import(.x) %>%
mutate(path = .x) %>%
mutate(month = as.character(month))
tmp_2021 <- dir("../raw_data/final/2021/", full.names = T) %>%
map_dfr(~{
rio::import(.x) %>%
mutate(path = .x) %>%
mutate(month = as.character(month))
})
final_2021 <- tmp_2021 %>%
mutate(tv = str_detect(tolower(path), "info|g.neraliste"),
radio = str_detect(tolower(path), "radio"),
type = ifelse(str_detect(type, "JT"), "JT", type),
time = parse_time(time),
month = parse_month(month)) %>%
mutate(channel = channel %>%
str_trim() %>%
recode_channel,
channel = ifelse(channel == "France Info" & tv, "France Info TV", channel),
funct = funct %>%
recode_func(),
party_abb = fix_fun(funct),
ideo_pos = ideo_pos(funct),
party_abb = fct_reorder(party_abb, desc(ideo_pos))
) %>%
fix_name %>%
select(-ideo_pos, -error) %>%
select(month, media = channel, tv, radio, prog_type = type, nom = name, appartenance = funct, party_abb, time, path) %>%
glimpse
final_2021 %>% count(media, tv, radio)
final_2021 %>% count(a = is.na(media), path) %>% filter(a)
final_2021 %>% count(prog_type)
final_2021 %>% count(appartenance)
final_2021 %>% count(appartenance, sort = T)
final_2021 %>% count(appartenance, sort = T)
final_2021 %>% count(appartenance)
final_2021 %>% count(party_abb)
summary(final_2021$time)
write_rds(final_2021, here::here("final_data/2021.rds"))
readr::write_csv(final_2021, here::here("final_data/2021.csv"))
